#!/usr/sbin/nft -f

flush ruleset

table inet filter {                                                                                        

  chain input {                                                                        
    type filter hook input priority 0; policy drop;                  
    ct state invalid counter drop             
    ct state { established, related } counter accept
    iif "lo" accept                                                                
    pkttype broadcast counter drop
    ip protocol icmp counter accept
    ip6 nexthdr icmpv6 counter accept
    pkttype multicast udp dport mdns counter accept
    tcp dport ssh counter log prefix "SSH: " accept
    counter log prefix "DROP: "
  }

  chain forward {
    type filter hook forward priority 0; policy drop;
    counter
  }

  chain output {
    type filter hook output priority 0; policy accept;
    counter
  }

}
