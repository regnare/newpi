#!/usr/sbin/nft -f

flush ruleset

table inet filter {                                                                                        

  chain input {                                                                        
    type filter hook input priority 0; policy drop;                  
    ct state invalid counter drop             
    ct state { established, related } counter accept
    iif "lo" accept                                                                
    meta pkttype broadcast counter drop
    ip protocol icmp counter accept
    ip6 nexthdr icmpv6 counter accept
    ip6 nexthdr udp udp dport 546 counter accept
    udp dport mdns counter accept
    tcp dport ssh counter log prefix "SSH: " accept
    counter log prefix "DROP: "
  }

}
